<style>
    .mud-button-label
    {
        height: 100%;
        display: block;
    }
</style>

<MudButton @ondblclick="() => OpenNewActivity = !OpenNewActivity" FullWidth Style="height:100%">
    <MudStack Spacing="1" Justify="Justify.SpaceBetween" AlignItems="AlignItems.Start" Style="height:100%">
        <MudText>@Day.Day</MudText>
        @foreach (Activity activity in Activities)
        {
            <MudStack Row Justify="Justify.SpaceBetween" Style="width:100%">
                <MudText Typo="Typo.caption">
                    @foreach (var groupName in activity.Groups.Select(g => g.Name))
                    {
                        @($"{groupName}, ")
                    }
                </MudText>
                <MudText Typo="Typo.caption">@($"{activity.DurationSeconds / 60}min")</MudText>
            </MudStack>
        }
        <div style="height:100%"/>
    </MudStack>
</MudButton>

<MudPopover AnchorOrigin="Origin.BottomCenter" TransformOrigin="Origin.TopCenter" Open=OpenNewActivity Fixed>
    <MudPaper Class="pa-2">
        <ActivityForm @bind-Show=OpenNewActivity Date="Day" Groups="Groups" />
    </MudPaper>
</MudPopover>

@code {
    [Parameter] public DateTime Day { get; set; }
    [Parameter] public IEnumerable<Activity> Activities { get; set; } = [];
    [Parameter] public IEnumerable<TeamGroup> Groups { get; set; } = [];
    private bool OpenNewActivity = false;
}
